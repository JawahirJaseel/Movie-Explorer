{"ast":null,"code":"import React,{useEffect,useState,useCallback}from\"react\";import axios from\"axios\";import{Grid,Button,CircularProgress,Box,Typography}from\"@mui/material\";import MovieCard from\"../components/MovieCard\";import Filters from\"../components/Filters\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_KEY=process.env.REACT_APP_TMDB_API_KEY;const Home=()=>{const[movies,setMovies]=useState([]);const[page,setPage]=useState(1);const[totalPages,setTotalPages]=useState(null);const[loading,setLoading]=useState(false);// Filter states\nconst[genres,setGenres]=useState([]);const[selectedGenre,setGenre]=useState(\"\");const[year,setYear]=useState(\"\");const[rating,setRating]=useState(0);// Fetch genre list once\nconst fetchGenres=useCallback(async()=>{try{const res=await axios.get(`https://api.themoviedb.org/3/genre/movie/list?api_key=${API_KEY}`);setGenres(res.data.genres);}catch(err){console.error(\"Error fetching genres:\",err);}},[]);// Fetch movies based on filters + page\nconst fetchMovies=useCallback(async()=>{try{setLoading(true);const res=await axios.get(\"https://api.themoviedb.org/3/discover/movie\",{params:{api_key:API_KEY,language:\"en-US\",page,with_genres:selectedGenre||undefined,primary_release_year:year||undefined,\"vote_average.gte\":rating||undefined}});setMovies(prev=>page===1?res.data.results:[...prev,...res.data.results]);setTotalPages(res.data.total_pages);}catch(err){console.error(\"Error fetching movies:\",err);}finally{setLoading(false);}},[page,selectedGenre,year,rating]);// Reset page to 1 on filter change\nuseEffect(()=>{setPage(1);},[selectedGenre,year,rating]);// Fetch genres on mount\nuseEffect(()=>{fetchGenres();},[fetchGenres]);// Fetch movies when page or filters change\nuseEffect(()=>{fetchMovies();},[fetchMovies]);const handleLoadMore=()=>{if(page<totalPages){setPage(prev=>prev+1);}};return/*#__PURE__*/_jsxs(Box,{p:2,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",textAlign:\"center\",gutterBottom:true,children:\"\\uD83C\\uDFAC Explore Movies\"}),/*#__PURE__*/_jsx(Filters,{genres:genres,selectedGenre:selectedGenre,setGenre:setGenre,year:year,setYear:setYear,rating:rating,setRating:setRating}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,mt:2,children:movies.map(movie=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,lg:3,children:/*#__PURE__*/_jsx(MovieCard,{movie:movie})},movie.id))}),/*#__PURE__*/_jsx(Box,{mt:4,textAlign:\"center\",children:loading?/*#__PURE__*/_jsx(CircularProgress,{}):page<totalPages&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleLoadMore,children:\"Load More\"})})]});};export default Home;","map":{"version":3,"names":["React","useEffect","useState","useCallback","axios","Grid","Button","CircularProgress","Box","Typography","MovieCard","Filters","jsx","_jsx","jsxs","_jsxs","API_KEY","process","env","REACT_APP_TMDB_API_KEY","Home","movies","setMovies","page","setPage","totalPages","setTotalPages","loading","setLoading","genres","setGenres","selectedGenre","setGenre","year","setYear","rating","setRating","fetchGenres","res","get","data","err","console","error","fetchMovies","params","api_key","language","with_genres","undefined","primary_release_year","prev","results","total_pages","handleLoadMore","p","children","variant","textAlign","gutterBottom","container","spacing","mt","map","movie","item","xs","sm","md","lg","id","onClick"],"sources":["D:/loonslab/movie-explorer/src/pages/Home.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Grid, Button, CircularProgress, Box, Typography } from \"@mui/material\";\r\nimport MovieCard from \"../components/MovieCard\";\r\nimport Filters from \"../components/Filters\";\r\n\r\nconst API_KEY = process.env.REACT_APP_TMDB_API_KEY;\r\n\r\nconst Home = () => {\r\n  const [movies, setMovies] = useState([]);\r\n  const [page, setPage] = useState(1);\r\n  const [totalPages, setTotalPages] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Filter states\r\n  const [genres, setGenres] = useState([]);\r\n  const [selectedGenre, setGenre] = useState(\"\");\r\n  const [year, setYear] = useState(\"\");\r\n  const [rating, setRating] = useState(0);\r\n\r\n  // Fetch genre list once\r\n  const fetchGenres = useCallback(async () => {\r\n    try {\r\n      const res = await axios.get(\r\n        `https://api.themoviedb.org/3/genre/movie/list?api_key=${API_KEY}`\r\n      );\r\n      setGenres(res.data.genres);\r\n    } catch (err) {\r\n      console.error(\"Error fetching genres:\", err);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch movies based on filters + page\r\n  const fetchMovies = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await axios.get(\r\n        \"https://api.themoviedb.org/3/discover/movie\",\r\n        {\r\n          params: {\r\n            api_key: API_KEY,\r\n            language: \"en-US\",\r\n            page,\r\n            with_genres: selectedGenre || undefined,\r\n            primary_release_year: year || undefined,\r\n            \"vote_average.gte\": rating || undefined,\r\n          },\r\n        }\r\n      );\r\n\r\n      setMovies((prev) =>\r\n        page === 1 ? res.data.results : [...prev, ...res.data.results]\r\n      );\r\n      setTotalPages(res.data.total_pages);\r\n    } catch (err) {\r\n      console.error(\"Error fetching movies:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [page, selectedGenre, year, rating]);\r\n\r\n  // Reset page to 1 on filter change\r\n  useEffect(() => {\r\n    setPage(1);\r\n  }, [selectedGenre, year, rating]);\r\n\r\n  // Fetch genres on mount\r\n  useEffect(() => {\r\n    fetchGenres();\r\n  }, [fetchGenres]);\r\n\r\n  // Fetch movies when page or filters change\r\n  useEffect(() => {\r\n    fetchMovies();\r\n  }, [fetchMovies]);\r\n\r\n  const handleLoadMore = () => {\r\n    if (page < totalPages) {\r\n      setPage((prev) => prev + 1);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box p={2}>\r\n      <Typography variant=\"h4\" textAlign=\"center\" gutterBottom>\r\n        ðŸŽ¬ Explore Movies\r\n      </Typography>\r\n\r\n      <Filters\r\n        genres={genres}\r\n        selectedGenre={selectedGenre}\r\n        setGenre={setGenre}\r\n        year={year}\r\n        setYear={setYear}\r\n        rating={rating}\r\n        setRating={setRating}\r\n      />\r\n\r\n      <Grid container spacing={2} mt={2}>\r\n        {movies.map((movie) => (\r\n          <Grid item key={movie.id} xs={12} sm={6} md={4} lg={3}>\r\n            <MovieCard movie={movie} />\r\n          </Grid>\r\n        ))}\r\n      </Grid>\r\n\r\n      <Box mt={4} textAlign=\"center\">\r\n        {loading ? (\r\n          <CircularProgress />\r\n        ) : (\r\n          page < totalPages && (\r\n            <Button variant=\"contained\" onClick={handleLoadMore}>\r\n              Load More\r\n            </Button>\r\n          )\r\n        )}\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}